CVE-2017-7494: 
"All versions of Samba from 3.5.0 onwards are vulnerable to a remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share, and then cause the server to load and execute it"

Upgrade instructions to samba 4.6.4

wget https://download.samba.org/pub/samba/stable/samba-4.6.4.tar.gz
tar -xzvf samba-4.6.4.tar.gz 
cd samba-4.6.4/
./configure --sysconfdir=/etc/samba/ --sbindir=/usr/sbin/ --mandir=/usr/share/man/

After the above step, you may encounter error as below
"samba-4.6.4/source3/wscript:507: error: ACL support not found. Try installing libacl1-dev or libacl-devel.  Otherwise, use --without-acl-support to build without ACL support. ACL support is required to change permissions from Windows clients."
if yes, then install libacl1-dev 

sudo apt-get install libacl1-dev 

./configure --sysconfdir=/etc/samba/ --sbindir=/usr/sbin/ --mandir=/usr/share/man/
make
sudo make install
sudo service smbd restart
sec@ubuntu:~$ smbd -V
Version 4.6.4
sec@ubuntu:~$ 


How to verify if the system is non-vulnerable after the upgrade
nmap --script gc-sambacry.nse -p445 <IP Address of your system> 
This will output system is 'Potentiall Vulnerable' if the sambacry vulnerability is detected

